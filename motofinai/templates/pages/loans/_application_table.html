{% if applications %}
  <table class="min-w-full divide-y divide-slate-200 text-left text-sm">
    <thead class="bg-slate-50 text-xs uppercase tracking-wide text-slate-500">
      <tr>
        <th scope="col" class="px-4 py-3">
          <a href="?{{ sort_url_name }}"
             hx-get="?{{ sort_url_name }}"
             hx-target="#application-table-container"
             hx-swap="innerHTML"
             class="group inline-flex items-center gap-1 hover:text-slate-700">
            Applicant
            {% if current_sort == 'name' %}
              {% if current_order == 'asc' %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
              {% else %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
              {% endif %}
            {% else %}
              <svg class="h-3 w-3 opacity-0 group-hover:opacity-50" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
            {% endif %}
          </a>
        </th>
        <th scope="col" class="px-4 py-3">
          <a href="?{{ sort_url_motorcycle }}"
             hx-get="?{{ sort_url_motorcycle }}"
             hx-target="#application-table-container"
             hx-swap="innerHTML"
             class="group inline-flex items-center gap-1 hover:text-slate-700">
            Motorcycle
            {% if current_sort == 'motorcycle' %}
              {% if current_order == 'asc' %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
              {% else %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
              {% endif %}
            {% else %}
              <svg class="h-3 w-3 opacity-0 group-hover:opacity-50" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
            {% endif %}
          </a>
        </th>
        <th scope="col" class="px-4 py-3">Term</th>
        <th scope="col" class="px-4 py-3">
          <a href="?{{ sort_url_monthly }}"
             hx-get="?{{ sort_url_monthly }}"
             hx-target="#application-table-container"
             hx-swap="innerHTML"
             class="group inline-flex items-center gap-1 hover:text-slate-700">
            Monthly
            {% if current_sort == 'monthly' %}
              {% if current_order == 'asc' %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
              {% else %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
              {% endif %}
            {% else %}
              <svg class="h-3 w-3 opacity-0 group-hover:opacity-50" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
            {% endif %}
          </a>
        </th>
        <th scope="col" class="px-4 py-3">
          <a href="?{{ sort_url_status }}"
             hx-get="?{{ sort_url_status }}"
             hx-target="#application-table-container"
             hx-swap="innerHTML"
             class="group inline-flex items-center gap-1 hover:text-slate-700">
            Status
            {% if current_sort == 'status' %}
              {% if current_order == 'asc' %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
              {% else %}
                <svg class="h-3 w-3" fill="currentColor" viewBox="0 0 20 20"><path d="M15 10l-5 5-5-5h10z"/></svg>
              {% endif %}
            {% else %}
              <svg class="h-3 w-3 opacity-0 group-hover:opacity-50" fill="currentColor" viewBox="0 0 20 20"><path d="M5 10l5-5 5 5H5z"/></svg>
            {% endif %}
          </a>
        </th>
        <th scope="col" class="px-4 py-3 text-right">Actions</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-200 text-slate-700">
      {% for application in applications %}
        <tr class="hover:bg-slate-50">
          <td class="px-4 py-3">
            <div class="font-medium text-slate-900">{{ application.applicant_full_name }}</div>
            <div class="text-xs text-slate-500">{{ application.applicant_email }}</div>
          </td>
          <td class="px-4 py-3">
            <div class="font-medium">{{ application.motor.display_name }}</div>
            <div class="text-xs text-slate-500">&#8369;{{ application.loan_amount|floatformat:2 }}</div>
          </td>
          <td class="px-4 py-3">{{ application.financing_term }}</td>
          <td class="px-4 py-3">&#8369;{{ application.monthly_payment|floatformat:2 }}</td>
          <td class="px-4 py-3">
            {% if application.status == 'pending' %}
              <span class="inline-flex items-center rounded-full bg-amber-100 px-3 py-1 text-xs font-semibold text-amber-700">Pending</span>
            {% elif application.status == 'approved' %}
              <span class="inline-flex items-center rounded-full bg-sky-100 px-3 py-1 text-xs font-semibold text-sky-700">Approved</span>
            {% elif application.status == 'active' %}
              <span class="inline-flex items-center rounded-full bg-emerald-100 px-3 py-1 text-xs font-semibold text-emerald-700">Active</span>
            {% elif application.status == 'completed' %}
              <span class="inline-flex items-center rounded-full bg-slate-200 px-3 py-1 text-xs font-semibold text-slate-700">Completed</span>
            {% elif application.status == 'returned' %}
              <span class="inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold text-white" style="background-color: #f97316;">Returned</span>
            {% elif application.status == 'rejected' %}
              <span class="inline-flex items-center rounded-full bg-rose-100 px-3 py-1 text-xs font-semibold text-rose-700">Rejected</span>
            {% elif application.status == 'cancelled' %}
              <span class="inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-500">Cancelled</span>
            {% else %}
              <span class="inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-semibold text-slate-700">{{ application.get_status_display }}</span>
            {% endif %}
          </td>
          <td class="px-4 py-3 text-right">
            <a href="{% url 'loans:detail' application.pk %}" class="text-sm font-medium text-sky-600 transition hover:text-sky-700">View</a>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <div class="px-4 py-12">
    <div class="flex flex-col items-center justify-center text-center">
      <svg class="h-16 w-16 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
      </svg>
      <h3 class="mt-4 text-base font-semibold text-slate-900">No loan applications found</h3>
      <p class="mt-2 max-w-md text-sm text-slate-700">No applications match your current filters. Try adjusting your search criteria.</p>
    </div>
  </div>
{% endif %}
